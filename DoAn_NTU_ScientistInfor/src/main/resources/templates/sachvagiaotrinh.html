<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSDL s√°ch v√† gi√°o tr√¨nh</title>
    <link rel="stylesheet" th:href="@{/css/sachvagiaotrinh.css}" />
</head>

<body>
    <div class="container">
        <!-- Sidebar -->
        
		<div th:insert="fragments/sidebar :: sidebar"></div>
        <!-- Main content -->
        <main class="main">
            <h1>C∆° s·ªü d·ªØ li·ªáu Khoa h·ªçc C√¥ng ngh·ªá</h1>
            <div th:insert="fragments/banner :: banner"></div>
            <div class="search-container">
                <h2><strong>T√¨m Ki·∫øm <span style="color:deeppink;">D·ªØ Li·ªáu</span></strong></h2>

                <form th:action="@{/quanlykhoahoc/giaotrinh}" method="get">
                    <input type="text" 
                           name="keyword" 
                           class="search-input" 
                           placeholder="üîç Nh·∫≠p t√™n s√°ch..." 
                           th:value="${keyword}">
                    <select name="nkhId" class="search-select">
                        <option value="">üîΩ Ch·ªçn t√°c gi·∫£</option>
                        <option th:each="nkh : ${danhSachNhaKhoaHoc}"
                                th:value="${nkh.id}"
                                th:text="${nkh.hoTen}"
                                th:selected="${nkh.id == selectedNkhId}"></option>
                    </select>
                    <select name="loaiSach" class="search-select">
                        <option value="">üîΩ Ch·ªçn lo·∫°i s√°ch</option>
                        <option th:each="loai : ${loaiSachList}"
                                th:value="${loai}"
                                th:text="${#strings.replace(loai, '_', ' ')}"
                                th:selected="${loai == selectedLoaiSach}"></option>
                    </select>
                    <button type="submit" class="search-button">üîç T√¨m Ki·∫øm</button>
                </form>
            </div>

            <div class="book-page">
                <div class="book-header" style="display: flex; justify-content: space-between; align-items: center;">
                	<div>
                		<h2>üìò S√ÅCH & GI√ÅO TR√åNH</h2>
                    	<div class="underline"></div>
                	</div>    
                    <a th:href="@{/quanlykhoahoc/giaotrinh/them-sach}" class="add-button" sec:authorize="hasAnyAuthority('Admin', 'NKH')">‚ûï Th√™m S√°ch</a>     
                </div>
                

                <div class="book-columns">
                    <div class="book-section">
                        <div class="book-list">
                            <div th:each="sach : ${danhSachSach}" class="book-card">
                                <a>
                                    <h4 th:text="${sach.tenSach}">T√™n s√°ch</h4>
                                </a>
                                <p><strong>T√°c gi·∫£:</strong> 
                                    <span th:each="tacgia,iterStat : ${tacGiaMap[sach.id]}" 
                                          th:with="isLast=${iterStat.last}"
                                          th:text="${tacgia} + ${isLast ? '' : ', '}"></span>
                                </p>
                                <p><strong>NƒÉm:</strong> <span th:text="${sach.namXuatBan.year}">NƒÉm</span></p>
                                <p><strong>Lo·∫°i s√°ch:</strong> <span th:with="formattedLoaiSach=${#strings.replace(sach.loaiSach, '_', ' ')}"
                                          th:text="${formattedLoaiSach}">Lo·∫°i s√°ch</span></p>
                                <p><strong>Nh√† xu·∫•t b·∫£n:</strong> <span th:with="formattedNhaXuatBan=${#strings.replace(sach.nhaXuatBan, '_', ' ')}"
                                          th:text="${formattedNhaXuatBan}">Nh√† xu·∫•t b·∫£n</span></p>
                                <div class="button">
                                    <a th:href="@{/quanlykhoahoc/giaotrinh/sua-sach-giao-trinh(id=${sach.id})}" class="details-btn" sec:authorize="hasAuthority('Admin')">S·ª≠a</a>
                                    <form th:action="@{/quanlykhoahoc/giaotrinh/xoa-sach/{id}(id=${sach.id})}" 
									      method="post"
									      onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s√°ch n√†y?')"
									      style="display: inline;">
									    <button type="submit" class="delete-btn" sec:authorize="hasAuthority('Admin')">X√≥a</button>
									</form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </main>


    </div>
    
<div th:insert="fragments/footer :: footer"></div>
</body>

</html>